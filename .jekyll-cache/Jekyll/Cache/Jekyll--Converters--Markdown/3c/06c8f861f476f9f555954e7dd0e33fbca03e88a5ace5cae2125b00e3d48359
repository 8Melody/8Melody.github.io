I"ÚM<blockquote>
  <p>ä½¿ç”¨CMakeè¿›è¡ŒNDKå¼€å‘ç®€è®°ã€‚</p>
</blockquote>

<h1 id="å‰è¨€">å‰è¨€</h1>

<p>æœ€è¿‘åœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œéƒ¨åˆ†ç½‘ç»œè¯·æ±‚çš„åŠ å¯†è§„åˆ™ç”±äºä¸€ç›´å†™åœ¨<code class="highlighter-rouge">Java</code>ä»£ç ä¸­ï¼Œå¾ˆå®¹æ˜“è¢«åç¼–è¯‘æ‰¾åˆ°å…³é”®åŠ å¯†è§„åˆ™å¯¼è‡´è¢«çˆ¬å–æ•°æ®ï¼Œæ‰€ä»¥åœ¨è¯„ä¼°äº†åŠ å¯†æ–¹æ¡ˆä¹‹åå†³å®šæŠŠåŠ å¯†è§„åˆ™ç”±<code class="highlighter-rouge">C++</code>å®ç°ï¼Œé€šè¿‡<code class="highlighter-rouge">NDK</code>ç¼–è¯‘ä¹‹åæä¾›ç»™<code class="highlighter-rouge">Java</code>å±‚ä½¿ç”¨ã€‚</p>

<p><code class="highlighter-rouge">NDK</code>ç¼–è¯‘çš„æ–¹å¼æœ‰ï¼š</p>

<ul>
  <li>åŸºäºMakeçš„<a href="https://developer.android.com/ndk/guides/ndk-build.html?hl=zh_cn">ndk-build</a></li>
  <li><a href="https://developer.android.com/ndk/guides/cmake.html?hl=zh_cn">CMake</a></li>
  <li><a href="https://developer.android.com/ndk/guides/standalone_toolchain.html?hl=zh_cn">ç‹¬ç«‹å·¥å…·é“¾</a>ç”¨äºä¸å…¶ä»–ç¼–è¯‘ç³»ç»Ÿé›†æˆï¼Œæˆ–ä¸åŸºäº <code class="highlighter-rouge">configure</code> çš„é¡¹ç›®æ­é…ä½¿ç”¨ã€‚</li>
</ul>

<p>æœ¬æ–‡è®°å½•<code class="highlighter-rouge">CMake</code>ç¼–è¯‘ã€‚</p>

<h1 id="cmake">CMake</h1>

<p><a href="https://developer.android.com/ndk/guides/cmake.html?hl=zh_cn">å…³äºCMakeçš„ä»‹ç»</a>ã€‚</p>

<h1 id="å¼€å§‹ä½¿ç”¨cmake">å¼€å§‹ä½¿ç”¨CMake</h1>

<h2 id="å®‰è£…cmake">å®‰è£…CMake</h2>

<p>åœ¨å¼€å§‹é¡¹ç›®å‰ï¼Œç¡®ä¿å·²å®‰è£…å¦‚ä¸‹ç¨‹åºï¼š</p>

<p><img src="https://qfxl.oss-cn-shanghai.aliyuncs.com/images/ndk1.png" alt="image" /></p>

<p>å…¶ä¸­<a href="https://lldb.llvm.org/">LLDB</a>å¯ä»¥ç”¨äºè°ƒè¯•<code class="highlighter-rouge">C++</code>ä»£ç ã€‚</p>

<h2 id="æŒ‡å®šndkç›®å½•">æŒ‡å®šNDKç›®å½•ã€‚</h2>

<p><img src="https://qfxl.oss-cn-shanghai.aliyuncs.com/images/ndk2.png" alt="image" /></p>

<h2 id="ç¼–å†™cæ–‡ä»¶">ç¼–å†™C++æ–‡ä»¶</h2>

<p>å€Ÿé‰´å®˜æ–¹ä¾‹å­ã€‚</p>

<p><img src="https://qfxl.oss-cn-shanghai.aliyuncs.com/images/ndk3.png" alt="image" /></p>

<p>CMakeLists.txt</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="err">#è®¾ç½®ç¼–è¯‘</span> <span class="kd">native</span> <span class="n">library</span> <span class="err">éœ€è¦æœ€å°çš„</span> <span class="n">cmake</span> <span class="err">ç‰ˆæœ¬</span>
<span class="n">cmake_minimum_required</span><span class="o">(</span><span class="no">VERSION</span> <span class="mf">3.4</span><span class="o">.</span><span class="mi">1</span><span class="o">)</span>

<span class="err">#å°†æŒ‡å®šçš„æºæ–‡ä»¶ç¼–è¯‘ä¸ºåä¸º</span> <span class="n">libnative</span><span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="na">so</span> <span class="err">çš„åŠ¨æ€åº“</span>
<span class="n">add_library</span><span class="o">(</span> <span class="err">#</span> <span class="nc">Sets</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">library</span><span class="o">.</span>
             <span class="kd">native</span><span class="o">-</span><span class="n">lib</span>

             <span class="err">#</span> <span class="nc">Sets</span> <span class="n">the</span> <span class="n">library</span> <span class="n">as</span> <span class="n">a</span> <span class="n">shared</span> <span class="n">library</span><span class="o">.</span>
             <span class="no">SHARED</span>

             <span class="err">#</span> <span class="nc">Provides</span> <span class="n">a</span> <span class="n">relative</span> <span class="n">path</span> <span class="n">to</span> <span class="n">your</span> <span class="n">source</span> <span class="nf">file</span><span class="o">(</span><span class="n">s</span><span class="o">).</span>
             <span class="kd">native</span><span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="na">cpp</span> <span class="o">)</span>

<span class="err">#æŸ¥æ‰¾æœ¬åœ°</span> <span class="n">log</span> <span class="err">åº“</span>
<span class="n">find_library</span><span class="o">(</span> <span class="err">#</span> <span class="nc">Sets</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">path</span> <span class="n">variable</span><span class="o">.</span>
              <span class="n">log</span><span class="o">-</span><span class="n">lib</span>

              <span class="err">#</span> <span class="nc">Specifies</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="no">NDK</span> <span class="n">library</span> <span class="n">that</span>
              <span class="err">#</span> <span class="n">you</span> <span class="n">want</span> <span class="nc">CMake</span> <span class="n">to</span> <span class="n">locate</span><span class="o">.</span>
              <span class="n">log</span> <span class="o">)</span>

<span class="err">#å°†é¢„æ„å»ºçš„åº“æ·»åŠ åˆ°è‡ªå·±çš„åŸç”Ÿåº“</span>
<span class="n">target_link_libraries</span><span class="o">(</span> <span class="err">#</span> <span class="nc">Specifies</span> <span class="n">the</span> <span class="n">target</span> <span class="n">library</span><span class="o">.</span>
                       <span class="kd">native</span><span class="o">-</span><span class="n">lib</span>

                       <span class="err">#</span> <span class="nc">Links</span> <span class="n">the</span> <span class="n">target</span> <span class="n">library</span> <span class="n">to</span> <span class="n">the</span> <span class="n">log</span> <span class="n">library</span>
                       <span class="err">#</span> <span class="n">included</span> <span class="n">in</span> <span class="n">the</span> <span class="no">NDK</span><span class="o">.</span>
                       <span class="err">$</span><span class="o">{</span><span class="n">log</span><span class="o">-</span><span class="n">lib</span><span class="o">}</span> <span class="o">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>native-lib.cpp</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;jni.h&gt;
#include &lt;string&gt;
</span>
<span class="k">extern</span> <span class="s">"C"</span> <span class="n">JNIEXPORT</span> <span class="n">jstring</span> <span class="n">JNICALL</span>
<span class="nf">Java_com_example_cmake_MainActivity_stringFromJNI</span><span class="p">(</span>
        <span class="n">JNIEnv</span><span class="o">*</span> <span class="n">env</span><span class="p">,</span>
        <span class="n">jobject</span> <span class="cm">/* this */</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">hello</span> <span class="o">=</span> <span class="s">"Hello from C++"</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">env</span><span class="o">-&gt;</span><span class="n">NewStringUTF</span><span class="p">(</span><span class="n">hello</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="gradleé…ç½®">Gradleé…ç½®</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre><span class="n">android</span> <span class="o">{</span>
    <span class="n">compileSdkVersion</span> <span class="mi">28</span>

    <span class="n">defaultConfig</span> <span class="o">{</span>
        <span class="n">applicationId</span> <span class="s">"com.example.cmake"</span>
        <span class="n">minSdkVersion</span> <span class="mi">17</span>
        <span class="n">targetSdkVersion</span> <span class="mi">28</span>
        <span class="n">versionCode</span> <span class="mi">1</span>
        <span class="n">versionName</span> <span class="s">"1.0"</span>

        <span class="n">testInstrumentationRunner</span> <span class="s">"android.support.test.runner.AndroidJUnitRunner"</span>
        <span class="n">externalNativeBuild</span> <span class="o">{</span>
            <span class="n">cmake</span> <span class="o">{</span>
                <span class="n">cppFlags</span> <span class="s">""</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">ndk</span> <span class="o">{</span>
            <span class="c1">//æŒ‡å®šABIä¸ºarmeabi-v7a</span>
            <span class="n">abiFilters</span> <span class="s">"armeabi-v7a"</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="n">buildTypes</span> <span class="o">{</span>
        <span class="n">release</span> <span class="o">{</span>
            <span class="n">minifyEnabled</span> <span class="kc">false</span>
            <span class="n">proguardFiles</span> <span class="nf">getDefaultProguardFile</span><span class="o">(</span><span class="err">'</span><span class="n">proguard</span><span class="o">-</span><span class="n">android</span><span class="o">-</span><span class="n">optimize</span><span class="o">.</span><span class="na">txt</span><span class="err">'</span><span class="o">),</span> <span class="err">'</span><span class="n">proguard</span><span class="o">-</span><span class="n">rules</span><span class="o">.</span><span class="na">pro</span><span class="err">'</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">externalNativeBuild</span> <span class="o">{</span>
        <span class="n">cmake</span> <span class="o">{</span>
            <span class="n">path</span> <span class="s">"src/main/cpp/CMakeLists.txt"</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="activity">Activity</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">MainActivity</span> <span class="o">:</span> <span class="nc">AppCompatActivity</span><span class="o">()</span> <span class="o">{</span>

    <span class="n">override</span> <span class="n">fun</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nl">savedInstanceState:</span> <span class="nc">Bundle</span><span class="o">?)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">)</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">)</span>
        <span class="n">sample_text</span><span class="o">.</span><span class="na">text</span> <span class="o">=</span> <span class="n">stringFromJNI</span><span class="o">()</span>
    <span class="o">}</span>

 
    <span class="n">external</span> <span class="n">fun</span> <span class="nf">stringFromJNI</span><span class="o">():</span> <span class="nc">String</span>

    <span class="n">companion</span> <span class="n">object</span> <span class="o">{</span>
        
        <span class="n">init</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">loadLibrary</span><span class="o">(</span><span class="s">"native-lib"</span><span class="o">)</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è‡³æ­¤ï¼ŒC++ä»£ç å·²ç»æ­£å¸¸æ‰§è¡Œã€‚</p>

<h1 id="cmakeç¼–è¯‘so">CMakeç¼–è¯‘so</h1>

<p>è¿™ä¸ªæ—¶å€™ç›´æ¥make projectå¯ä»¥åœ¨ç›®å½•<code class="highlighter-rouge">å·¥ä½œç›®å½•\build\intermediates\cmake\debug</code>ä¸‹çœ‹åˆ°å„ABIå¯¹åº”çš„soæ–‡ä»¶ã€‚</p>

<p><img src="https://qfxl.oss-cn-shanghai.aliyuncs.com/images/ndk_4.png" alt="image" /></p>

<h1 id="cmakeæŒ‡ä»¤">CMakeæŒ‡ä»¤</h1>

<p><em>æ³¨ï¼šæŒ‡ä»¤ä¸å¤§å°å†™æ— å…³ï¼Œå®˜æ–¹å»ºè®®ä½¿ç”¨å¤§å†™ï¼Œä¸è¿‡ Android çš„ CMake æŒ‡ä»¤æ˜¯å°å†™çš„ï¼Œä¸‹é¢ä¸ºäº†ä¾¿äºé˜…è¯»ï¼Œé‡‡å–å°å†™çš„æ–¹å¼ã€‚</em></p>

<h2 id="project">project</h2>

<p>è¯­æ³•ï¼š<code class="highlighter-rouge">project( [CXX] [C] [Java])</code>
è¿™ä¸ªæŒ‡ä»¤æ˜¯å®šä¹‰å·¥ç¨‹åç§°çš„ï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®šå·¥ç¨‹æ”¯æŒçš„è¯­è¨€ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥å¿½ç•¥ï¼Œé»˜è®¤æƒ…å†µè¡¨ç¤ºæ”¯æŒæ‰€æœ‰è¯­è¨€ï¼‰ï¼Œä¸æ˜¯å¼ºåˆ¶å®šä¹‰çš„ã€‚ä¾‹å¦‚ï¼šproject(HELLO)
å®šä¹‰å®Œè¿™ä¸ªæŒ‡ä»¤ä¼šéšå¼å®šä¹‰äº†ä¸¤ä¸ªå˜é‡ï¼š
<code class="highlighter-rouge">&lt;projectname&gt;_BINARY_DIR</code>å’Œ<code class="highlighter-rouge">&lt;projectname&gt;_SOURCE_DIR</code>ï¼Œ
<code class="highlighter-rouge">MESSAGE</code>æŒ‡ä»¤æœ‰ç”¨åˆ°è¿™ä¸¤ä¸ªå˜é‡ï¼›</p>

<p>å¦å¤– CMake ç³»ç»Ÿè¿˜ä¼šé¢„å®šä¹‰äº† <code class="highlighter-rouge">PROJECT_BINARY_DIR</code> å’Œ <code class="highlighter-rouge">PROJECT_SOURCE_DIR</code> å˜é‡ï¼Œå®ƒä»¬çš„å€¼å’Œä¸Šé¢ä¸¤ä¸ªçš„å˜é‡å¯¹åº”çš„å€¼æ˜¯ä¸€è‡´çš„ã€‚ä¸è¿‡ä¸ºäº†ç»Ÿä¸€èµ·è§ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨<code class="highlighter-rouge">PROJECT_BINARY_DIR</code> å’Œ<code class="highlighter-rouge">PROJECT_SOURCE_DIR</code>ï¼Œå³ä½¿ä»¥åä¿®æ”¹äº†å·¥ç¨‹åå­—ï¼Œä¹Ÿä¸ä¼šå½±å“ä¸¤ä¸ªå˜é‡çš„ä½¿ç”¨ã€‚</p>

<h2 id="set">set</h2>

<p>è¯­æ³•ï¼š<code class="highlighter-rouge">set(VAR [VALUE])</code>
è¿™ä¸ªæŒ‡ä»¤æ˜¯ç”¨æ¥æ˜¾å¼åœ°å®šä¹‰å˜é‡ï¼Œå¤šä¸ªå˜é‡ç”¨ç©ºæ ¼æˆ–åˆ†å·éš”å¼€
ä¾‹å¦‚ï¼š</p>
<blockquote>
  <p>set(SRC_LIST main.c test.c)</p>
</blockquote>

<p><strong>æ³¨æ„ï¼Œå½“éœ€è¦ç”¨åˆ°å®šä¹‰çš„ SRC_LIST å˜é‡æ—¶ï¼Œéœ€è¦ç”¨${var}çš„å½¢å¼æ¥å¼•ç”¨ï¼Œå¦‚ï¼š${SRC_LIST}
ä¸è¿‡ï¼Œåœ¨ IF æ§åˆ¶è¯­å¥ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨å˜é‡åã€‚</strong></p>

<h2 id="message">message</h2>

<p>è¯­æ³•ï¼š<code class="highlighter-rouge">message([SEND_ERROR | STATUS | FATAL_ERROR] â€œmessage to displayâ€ â€¦ )</code>
è¿™ä¸ªæŒ‡ä»¤ç”¨äºå‘ç»ˆç«¯è¾“å‡ºç”¨æˆ·å®šä¹‰çš„ä¿¡æ¯ï¼ŒåŒ…å«äº†ä¸‰ç§ç±»å‹ï¼š
<code class="highlighter-rouge">SEND_ERROR</code>ï¼Œäº§ç”Ÿé”™è¯¯ï¼Œç”Ÿæˆè¿‡ç¨‹è¢«è·³è¿‡ï¼›
<code class="highlighter-rouge">STATUS</code>ï¼Œè¾“å‡ºå‰ç¼€ä¸ºâ€”-çš„ä¿¡æ¯;
<code class="highlighter-rouge">FATAL_ERROR</code>ï¼Œç«‹å³ç»ˆæ­¢æ‰€æœ‰ CMake è¿‡ç¨‹ï¼›</p>

<h2 id="add_executable">add_executable</h2>

<p>è¯­æ³•ï¼š<code class="highlighter-rouge">add_executable(executable_file_name [source])</code>
å°†ä¸€ç»„æºæ–‡ä»¶ source ç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚ source å¯ä»¥æ˜¯å¤šä¸ªæºæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹åº”å®šä¹‰çš„å˜é‡
å¦‚ï¼š</p>
<blockquote>
  <p>add_executable(hello main.c)</p>
</blockquote>

<h2 id="cmake_minimun_requiredversion-xxx">cmake_minimun_required(VERSION x.x.x)</h2>

<p>ç”¨æ¥æŒ‡å®š <code class="highlighter-rouge">CMake</code> æœ€ä½ç‰ˆæœ¬ä¸ºx.x.xï¼Œå¦‚æœæ²¡æŒ‡å®šï¼Œæ‰§è¡Œ <code class="highlighter-rouge">cmake</code> å‘½ä»¤æ—¶å¯èƒ½ä¼šå‡ºé”™ã€‚</p>

<h2 id="add_subdirectory">add_subdirectory</h2>

<p>è¯­æ³•ï¼š<code class="highlighter-rouge">add_subdirectory(source_dir [binary_dir] [EXCLUDE_FROM_ALL])</code>
è¿™ä¸ªæŒ‡ä»¤ç”¨äºå‘å½“å‰å·¥ç¨‹æ·»åŠ å­˜æ”¾æºæ–‡ä»¶çš„å­ç›®å½•ï¼Œå¹¶å¯ä»¥æŒ‡å®šä¸­é—´äºŒè¿›åˆ¶å’Œç›®æ ‡äºŒè¿›åˆ¶å­˜æ”¾çš„ä½ç½®ã€‚<code class="highlighter-rouge">EXCLUDE_FROM_ALL</code>å‚æ•°å«ä¹‰æ˜¯å°†è¿™ä¸ªç›®å½•ä»ç¼–è¯‘è¿‡ç¨‹ä¸­æ’é™¤ã€‚</p>

<p>å¦å¤–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ SET æŒ‡ä»¤é‡æ–°å®šä¹‰ <code class="highlighter-rouge">EXECUTABLE_OUTPUT_PATH</code> å’Œ <code class="highlighter-rouge">LIBRARY_OUTPUT_PATH</code> å˜é‡æ¥æŒ‡å®šæœ€ç»ˆçš„ç›®æ ‡äºŒè¿›åˆ¶çš„ä½ç½®(æŒ‡æœ€ç»ˆç”Ÿæˆçš„ hello æˆ–è€…æœ€ç»ˆçš„å…±äº«åº“ï¼Œä¸åŒ…å«ç¼–è¯‘ç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶)</p>
<blockquote>
  <p>set(EXECUTABLE_OUTPUT_PATH ${PROJECT_BINARY_DIR}/bin)</p>
</blockquote>

<blockquote>
  <p>set(LIBRARY_OUTPUT_PATH ${PROJECT_BINARY_DIR}/lib)</p>
</blockquote>

<h2 id="add_library">add_library</h2>

<p>è¯­æ³•ï¼š<code class="highlighter-rouge">add_library(libname [SHARED | STATIC | MODULE] [EXCLUDE_FROM_ALL] [source])</code>
å°†ä¸€ç»„æºæ–‡ä»¶ <code class="highlighter-rouge">source</code> ç¼–è¯‘å‡ºä¸€ä¸ªåº“æ–‡ä»¶ï¼Œå¹¶ä¿å­˜ä¸º <code class="highlighter-rouge">libname.so</code> (lib å‰ç¼€æ˜¯ç”Ÿæˆæ–‡ä»¶æ—¶ CMakeè‡ªåŠ¨æ·»åŠ ä¸Šå»çš„)ã€‚å…¶ä¸­æœ‰ä¸‰ç§åº“æ–‡ä»¶ç±»å‹ï¼Œä¸å†™çš„è¯ï¼Œé»˜è®¤ä¸º STATIC:</p>

<ul>
  <li>SHARED: è¡¨ç¤ºåŠ¨æ€åº“ï¼Œå¯ä»¥åœ¨(Java)ä»£ç ä¸­ä½¿ç”¨ <code class="highlighter-rouge">System.loadLibrary(name)</code> åŠ¨æ€è°ƒç”¨ï¼›</li>
  <li>STATIC: è¡¨ç¤ºé™æ€åº“ï¼Œé›†æˆåˆ°ä»£ç ä¸­ä¼šåœ¨ç¼–è¯‘æ—¶è°ƒç”¨ï¼›</li>
  <li>MODULE: åªæœ‰åœ¨ä½¿ç”¨ dyId çš„ç³»ç»Ÿæœ‰æ•ˆï¼Œå¦‚æœä¸æ”¯æŒ dyIdï¼Œåˆ™è¢«å½“ä½œ SHARED å¯¹å¾…ï¼›</li>
  <li>EXCLUDE_FROM_ALL: è¡¨ç¤ºè¿™ä¸ªåº“ä¸è¢«é»˜è®¤æ„å»ºï¼Œé™¤éå…¶ä»–ç»„ä»¶ä¾èµ–æˆ–æ‰‹å·¥æ„å»º</li>
</ul>

<blockquote>
  <p>å°†compress.c ç¼–è¯‘æˆ libcompress.so çš„å…±äº«åº“
  add_library(compress SHARED compress.c)</p>
</blockquote>

<p><code class="highlighter-rouge">add_library</code> å‘½ä»¤ä¹Ÿå¯ä»¥ç”¨æ¥å¯¼å…¥ç¬¬ä¸‰æ–¹çš„åº“:
<code class="highlighter-rouge">add_library(libname [SHARED | STATIC | MODULE | UNKNOWN] IMPORTED)</code>
å¦‚ï¼Œå¯¼å…¥ libjpeg.so</p>

<blockquote>
  <p>add_library(libjpeg SHARED IMPORTED)</p>
</blockquote>

<p>å¯¼å…¥åº“åï¼Œå½“éœ€è¦ä½¿ç”¨ <code class="highlighter-rouge">target_link_libraries</code> é“¾æ¥åº“æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥åº“ã€‚</p>

<h2 id="find_library">find_library</h2>

<p>è¯­æ³•ï¼š<code class="highlighter-rouge">find_library( name1 path1 path2 â€¦)</code>
<code class="highlighter-rouge">VAR</code> å˜é‡è¡¨ç¤ºæ‰¾åˆ°çš„åº“å…¨è·¯å¾„ï¼ŒåŒ…å«åº“æ–‡ä»¶å ã€‚ä¾‹å¦‚ï¼š</p>

<blockquote>
  <p>find_library(libX  X11 /usr/lib)
  find_library(log-lib log)  #è·¯å¾„ä¸ºç©ºï¼Œåº”è¯¥æ˜¯æŸ¥æ‰¾ç³»ç»Ÿç¯å¢ƒå˜é‡è·¯å¾„</p>
</blockquote>

<h2 id="set_target_properties">set_target_properties</h2>

<p>è¯­æ³•: <code class="highlighter-rouge">set_target_properties(target1 target2 â€¦ PROPERTIES prop1 value1 prop2 value2 â€¦)</code>
è¿™æ¡æŒ‡ä»¤å¯ä»¥ç”¨æ¥è®¾ç½®è¾“å‡ºçš„åç§°ï¼ˆè®¾ç½®æ„å»ºåŒåçš„åŠ¨æ€åº“å’Œé™æ€åº“ï¼Œæˆ–è€…æŒ‡å®šè¦å¯¼å…¥çš„åº“æ–‡ä»¶çš„è·¯å¾„ï¼‰ï¼Œå¯¹äºåŠ¨æ€åº“ï¼Œè¿˜å¯ä»¥ç”¨æ¥æŒ‡å®šåŠ¨æ€åº“ç‰ˆæœ¬å’Œ API ç‰ˆæœ¬ã€‚
å¦‚ï¼Œ</p>
<blockquote>
  <p>set_target_properties(hello_static PROPERTIES OUTPUT_NAME â€œhelloâ€)</p>
</blockquote>

<h2 id="include_directories">include_directories</h2>

<p>è¯­æ³•ï¼š<code class="highlighter-rouge">include_directories([AFTER | BEFORE] [SYSTEM] dir1 dir2â€¦)</code>
è¿™ä¸ªæŒ‡ä»¤å¯ä»¥ç”¨æ¥å‘å·¥ç¨‹æ·»åŠ å¤šä¸ªç‰¹å®šçš„å¤´æ–‡ä»¶æœç´¢è·¯å¾„ï¼Œè·¯å¾„ä¹‹é—´ç”¨ç©ºæ ¼åˆ†å‰²ï¼Œå¦‚æœè·¯å¾„ä¸­åŒ…å«äº†ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨åŒå¼•å·å°†å®ƒæ‹¬èµ·æ¥ï¼Œé»˜è®¤çš„è¡Œä¸ºæ˜¯è¿½åŠ åˆ°å½“å‰çš„å¤´æ–‡ä»¶æœç´¢è·¯å¾„çš„
åé¢ã€‚</p>

<h2 id="target_link_libraries">target_link_libraries</h2>

<p>è¯­æ³•ï¼š<code class="highlighter-rouge">target_link_libraries(target library library2â€¦)</code>
è¿™ä¸ªæŒ‡ä»¤å¯ä»¥ç”¨æ¥ä¸º target æ·»åŠ éœ€è¦çš„é“¾æ¥çš„å…±äº«åº“ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥ç”¨äºä¸ºè‡ªå·±ç¼–å†™çš„å…±äº«åº“æ·»åŠ å…±äº«åº“é“¾æ¥ã€‚
å¦‚ï¼š</p>

<blockquote>
  <p>#æŒ‡å®š compress å·¥ç¨‹éœ€è¦ç”¨åˆ° libjpeg åº“å’Œ log åº“
  target_link_libraries(compress libjpeg ${log-lib})</p>
</blockquote>
:ET